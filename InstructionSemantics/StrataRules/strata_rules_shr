(shr r64, imm8) -> (OP1 = (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] ; CF := (OP2[7:0] & 0x3f_8) >= 0x40_8 bool_and undefined bool_or !((OP2[7:0] & 0x3f_8) >= 0x40_8) bool_and (!((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[0:0] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and CF) ; PF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and !((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[1:1] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[2:2] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[3:3] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[4:4] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[5:5] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[6:6] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[7:7] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[8:8] == 0x1_1) bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and PF ; ZF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] == 0x0_64 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and ZF ; SF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:64] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and SF ; OF := (OP2[7:0] & 0x3f_8) == 0x1_8 bool_and OP1[63:63] == 0x1_1 bool_or !((OP2[7:0] & 0x3f_8) == 0x1_8) bool_and OF)
(shr r64, cl) -> (OP1 = (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] ; CF := (OP2[7:0] & 0x3f_8) >= 0x40_8 bool_and undefined bool_or !((OP2[7:0] & 0x3f_8) >= 0x40_8) bool_and (!((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[0:0] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and CF) ; PF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and !((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[1:1] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[2:2] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[3:3] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[4:4] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[5:5] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[6:6] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[7:7] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[8:8] == 0x1_1) bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and PF ; ZF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] == 0x0_64 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and ZF ; SF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:64] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and SF ; OF := (OP2[7:0] & 0x3f_8) == 0x1_8 bool_and OP1[63:63] == 0x1_1 bool_or !((OP2[7:0] & 0x3f_8) == 0x1_8) bool_and OF)
(shr m64, imm8) -> (OP1 = ((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1])[63:0] ; CF := (OP2[7:0] & 0x3f_8) >= 0x40_8 bool_and undefined bool_or !((OP2[7:0] & 0x3f_8) >= 0x40_8) bool_and (!((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[0:0] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and CF) ; PF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and !((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[1:1] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[2:2] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[3:3] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[4:4] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[5:5] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[6:6] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[7:7] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[8:8] == 0x1_1) bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and PF ; ZF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] == 0x0_64 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and ZF ; SF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:64] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and SF ; OF := (OP2[7:0] & 0x3f_8) == 0x1_8 bool_and OP1[63:63] == 0x1_1 bool_or !((OP2[7:0] & 0x3f_8) == 0x1_8) bool_and OF)
(shr m64, cl) -> (OP1 = ((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1])[63:0] ; CF := (OP2[7:0] & 0x3f_8) >= 0x40_8 bool_and undefined bool_or !((OP2[7:0] & 0x3f_8) >= 0x40_8) bool_and (!((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[0:0] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and CF) ; PF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and !((OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[1:1] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[2:2] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[3:3] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[4:4] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[5:5] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[6:6] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[7:7] == 0x1_1 bool_xor (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[8:8] == 0x1_1) bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and PF ; ZF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:1] == 0x0_64 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and ZF ; SF := !((OP2[7:0] & 0x3f_8) == 0x0_8) bool_and (OP1 o 0x0_1 >> 0x0_57 o (OP2[7:0] & 0x3f_8))[64:64] == 0x1_1 bool_or !(!((OP2[7:0] & 0x3f_8) == 0x0_8)) bool_and SF ; OF := (OP2[7:0] & 0x3f_8) == 0x1_8 bool_and OP1[63:63] == 0x1_1 bool_or !((OP2[7:0] & 0x3f_8) == 0x1_8) bool_and OF)
